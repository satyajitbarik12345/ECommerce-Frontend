{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Row,Col,Form,Button}from'react-bootstrap';import{Link}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{userDetails,userUpdateDetails,checkTokenValidation,logout}from'../actions/userActions';import Message from'../components/Message';import{Spinner}from'react-bootstrap';import{useHistory}from'react-router-dom';import{UPDATE_USER_DETAILS_RESET}from'../constants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AccountUpdatePage(){let history=useHistory();const dispatch=useDispatch();// check token validation reducer\nconst checkTokenValidationReducer=useSelector(state=>state.checkTokenValidationReducer);const{error:tokenError}=checkTokenValidationReducer;const[username,setUsername]=useState(\"\");const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[confirmPassword,setConfirmPassword]=useState(\"\");// login reducer\nconst userLoginReducer=useSelector(state=>state.userLoginReducer);const{userInfo}=userLoginReducer;// user details reducer\nconst userDetailsReducer=useSelector(state=>state.userDetailsReducer);const{user:userAccDetails,loading}=userDetailsReducer;// user update details reducer\nconst userDetailsUpdateReducer=useSelector(state=>state.userDetailsUpdateReducer);const{success}=userDetailsUpdateReducer;useEffect(()=>{if(!userInfo){history.push(\"/login\");}dispatch(checkTokenValidation());dispatch(userDetails(userInfo.id));},[dispatch,history,userInfo]);if(userInfo&&tokenError===\"Request failed with status code 401\"){alert(\"Session expired, please login again.\");dispatch(logout());history.push(\"/login\");window.location.reload();}const onSubmit=e=>{e.preventDefault();const updatedUsername=username===\"\"?userAccDetails.username:username;const updatedEmail=email===\"\"?userAccDetails.email:email;if(password!==confirmPassword){alert(\"Passwords do not match\");}else{const userData={'username':updatedUsername,'email':updatedEmail,'password':password};dispatch(userUpdateDetails(userData));}};// logout\nconst logoutHandler=()=>{history.push(\"/login\");dispatch(logout());// action        \n};if(success){alert(\"Account successfully updated.\");dispatch({type:UPDATE_USER_DETAILS_RESET});history.push(\"/account/\");dispatch(userDetails(userInfo.id));}const renderData=()=>{try{return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Row,{className:\"justify-content-md-center\",children:/*#__PURE__*/_jsxs(Col,{xs:12,md:6,children:[/*#__PURE__*/_jsx(\"span\",{className:\"d-flex justify-content-center\",style:{display:\"flex\",marginBottom:\"15px\",color:\"#008080\"},children:/*#__PURE__*/_jsx(\"em\",{children:\"Update User Details\"})}),loading&&/*#__PURE__*/_jsx(Spinner,{animation:\"border\"}),/*#__PURE__*/_jsxs(Form,{onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"username\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Username\"}),/*#__PURE__*/_jsx(Form.Control,{autoFocus:true,type:\"text\",defaultValue:userAccDetails.username,placeholder:\"username\",onChange:e=>setUsername(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email Address\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",placeholder:\"enter email\",defaultValue:userAccDetails.email,onChange:e=>setEmail(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Reset-Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"enter new password\",onChange:e=>setPassword(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"confirmPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Confirm Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"confirm new password\",onChange:e=>setConfirmPassword(e.target.value)})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"success\",className:\"btn-sm\",children:\"Save Changes\"}),/*#__PURE__*/_jsx(Link,{to:`/account`,children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-sm ml-2\",type:\"button\",children:\"Cancel\"})})]})]})})});}catch(error){return/*#__PURE__*/_jsxs(Message,{variant:\"danger\",children:[\"Something went wrong, go back to \",/*#__PURE__*/_jsx(Link,{onClick:logoutHandler,to:`/login`,children:\" Login\"}),\" page.\"]});}};return renderData();}export default AccountUpdatePage;","map":{"version":3,"names":["React","useState","useEffect","Row","Col","Form","Button","Link","useDispatch","useSelector","userDetails","userUpdateDetails","checkTokenValidation","logout","Message","Spinner","useHistory","UPDATE_USER_DETAILS_RESET","jsx","_jsx","jsxs","_jsxs","AccountUpdatePage","history","dispatch","checkTokenValidationReducer","state","error","tokenError","username","setUsername","email","setEmail","password","setPassword","confirmPassword","setConfirmPassword","userLoginReducer","userInfo","userDetailsReducer","user","userAccDetails","loading","userDetailsUpdateReducer","success","push","id","alert","window","location","reload","onSubmit","e","preventDefault","updatedUsername","updatedEmail","userData","logoutHandler","type","renderData","children","className","xs","md","style","display","marginBottom","color","animation","Group","controlId","Label","Control","autoFocus","defaultValue","placeholder","onChange","target","value","variant","to","onClick"],"sources":["E:/FrontendEcommerce/frontend/src/pages/AccountUpdatePage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Row, Col, Form, Button } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { userDetails, userUpdateDetails, checkTokenValidation, logout } from '../actions/userActions'\nimport Message from '../components/Message'\nimport { Spinner } from 'react-bootstrap'\nimport {useHistory} from 'react-router-dom'\nimport { UPDATE_USER_DETAILS_RESET } from '../constants'\n\n\nfunction AccountUpdatePage() {\n\n    let history = useHistory()\n    const dispatch = useDispatch()\n  \n\n    // check token validation reducer\n    const checkTokenValidationReducer = useSelector(state => state.checkTokenValidationReducer)\n    const { error: tokenError } = checkTokenValidationReducer\n\n    const [username, setUsername] = useState(\"\")\n    const [email, setEmail] = useState(\"\")\n    const [password, setPassword] = useState(\"\")\n    const [confirmPassword, setConfirmPassword] = useState(\"\")\n\n    // login reducer\n    const userLoginReducer = useSelector(state => state.userLoginReducer)\n    const { userInfo } = userLoginReducer\n\n    // user details reducer\n    const userDetailsReducer = useSelector(state => state.userDetailsReducer)\n    const { user: userAccDetails, loading } = userDetailsReducer\n\n    // user update details reducer\n    const userDetailsUpdateReducer = useSelector(state => state.userDetailsUpdateReducer)\n    const { success } = userDetailsUpdateReducer\n\n    useEffect(() => {\n        if (!userInfo) {\n            history.push(\"/login\")\n        }\n        dispatch(checkTokenValidation())\n        dispatch(userDetails(userInfo.id))\n    }, [dispatch, history, userInfo])\n\n    if (userInfo && tokenError === \"Request failed with status code 401\") {\n        alert(\"Session expired, please login again.\")\n        dispatch(logout())\n        history.push(\"/login\")\n        window.location.reload()\n      }\n\n    const onSubmit = (e) => {\n        e.preventDefault()\n        const updatedUsername = username === \"\" ? userAccDetails.username : username\n        const updatedEmail = email === \"\" ? userAccDetails.email : email\n\n        if (password !== confirmPassword) {\n            alert(\"Passwords do not match\")\n        } else {\n            const userData = {\n                'username': updatedUsername,\n                'email': updatedEmail,\n                'password': password,\n            }\n            dispatch(userUpdateDetails(userData))\n        }\n    }\n\n    // logout\n    const logoutHandler = () => {\n        history.push(\"/login\")\n        dispatch(logout()) // action        \n    }\n\n    if(success) {\n        alert(\"Account successfully updated.\")\n        dispatch({\n            type: UPDATE_USER_DETAILS_RESET\n        })\n        history.push(\"/account/\")\n        dispatch(userDetails(userInfo.id))\n    }\n\n    const renderData = () => {\n        try {\n            return (\n                <div>\n                    <Row className='justify-content-md-center'>\n                        <Col xs={12} md={6}>\n                            <span\n                                className=\"d-flex justify-content-center\"\n                                style={{ display: \"flex\", marginBottom: \"15px\", color: \"#008080\" }}>\n                                <em>Update User Details</em>\n                            </span>\n                            {loading && <Spinner animation=\"border\" />}\n                            <Form onSubmit={onSubmit}>\n\n                                <Form.Group controlId='username'>\n                                    <Form.Label>\n                                        Username\n                                    </Form.Label>\n                                    <Form.Control\n                                        autoFocus={true}\n                                        type=\"text\"\n                                        defaultValue={userAccDetails.username}\n                                        placeholder=\"username\"\n                                        onChange={(e) => setUsername(e.target.value)}\n                                    >\n                                    </Form.Control>\n                                </Form.Group>\n\n                                <Form.Group controlId='email'>\n                                    <Form.Label>\n                                        Email Address\n                                    </Form.Label>\n                                    <Form.Control\n                                        type=\"email\"\n                                        placeholder=\"enter email\"\n                                        defaultValue={userAccDetails.email}\n                                        onChange={(e) => setEmail(e.target.value)}\n                                    >\n                                    </Form.Control>\n                                </Form.Group>\n\n                                <Form.Group controlId='password'>\n                                    <Form.Label>\n                                        Reset-Password\n                                    </Form.Label>\n                                    <Form.Control\n                                        type=\"password\"\n                                        placeholder=\"enter new password\"\n                                        onChange={(e) => setPassword(e.target.value)}\n                                    >\n                                    </Form.Control>\n                                </Form.Group>\n\n                                <Form.Group controlId='confirmPassword'>\n                                    <Form.Label>\n                                        Confirm Password\n                                    </Form.Label>\n                                    <Form.Control\n                                        type=\"password\"\n                                        placeholder=\"confirm new password\"\n                                        onChange={(e) => setConfirmPassword(e.target.value)}\n                                    >\n                                    </Form.Control>\n                                </Form.Group>\n\n                                <Button type=\"submit\" variant='success' className=\"btn-sm\">Save Changes</Button>\n                                <Link to={`/account`}>\n                                    <button className=\"btn btn-primary btn-sm ml-2\" type=\"button\">\n                                        Cancel\n                                    </button>\n                                </Link>\n                            </Form>\n                        </Col>\n                    </Row>\n                </div>\n            )\n        } catch (error) {\n            return <Message variant='danger'>Something went wrong, go back to <Link\n                onClick={logoutHandler} to={`/login`}\n            > Login</Link> page.</Message>\n        }\n    }\n\n    return renderData()\n}\n\nexport default AccountUpdatePage\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}